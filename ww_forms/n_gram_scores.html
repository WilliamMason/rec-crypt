<html>
<!---------  scores for di-, tri-, tet- and pentagraphs --------->
<head>
<!-- load pent_values array , more compressed version-->
<script type="text/javascript" src="english_pent_base64.js">
</script>

<!-- load tri_values array -->
<script type="text/javascript" src="tritable.js">
</script>
<!-- load tet_values array -->
<script type="text/javascript" src="tettable.js">
</script>

<script type="text/javascript">
var logdi = new Array(
[4,7,8,7,4,6,7,5,7,3,6,8,7,9,3,7,3,9,8,9,6,7,6,5,7,4],
 [7,4,2,0,8,1,1,1,6,3,0,7,2,1,7,1,0,6,5,3,7,1,2,0,6,0],
 [8,2,5,2,7,3,2,8,7,2,7,6,2,1,8,2,2,6,4,7,6,1,3,0,4,0],
 [7,6,5,6,8,6,5,5,8,4,3,6,6,5,7,5,3,6,7,7,6,5,6,0,6,2],
 [9,7,8,8,8,7,6,6,7,4,5,8,7,9,7,7,5,9,9,8,5,7,7,6,7,3],
 [7,4,5,3,7,6,4,4,7,2,2,6,5,3,8,4,0,7,5,7,6,2,4,0,5,0],
 [7,5,5,4,7,5,5,7,7,3,2,6,5,5,7,5,2,7,6,6,6,3,5,0,5,1],
 [8,5,4,4,9,4,3,4,8,3,1,5,5,4,8,4,2,6,5,7,6,2,5,0,5,0],
 [7,5,8,7,7,7,7,4,4,2,5,8,7,9,7,6,4,7,8,8,4,7,3,5,0,5],
 [5,0,0,0,4,0,0,0,3,0,0,0,0,0,5,0,0,0,0,0,6,0,0,0,0,0],
 [5,4,3,2,7,4,2,4,6,2,2,4,3,6,5,3,1,3,6,5,3,0,4,0,5,0],
 [8,5,5,7,8,5,4,4,8,2,5,8,5,4,8,5,2,4,6,6,6,5,5,0,7,1],
 [8,6,4,3,8,4,2,4,7,1,0,4,6,4,7,6,1,3,6,5,6,1,4,0,6,0],
 [8,6,7,8,8,6,9,6,8,4,6,6,5,6,8,5,3,5,8,9,6,5,6,3,6,2],
 [6,6,7,7,6,8,6,6,6,3,6,7,8,9,7,7,3,9,7,8,9,6,8,4,5,3],
 [7,3,3,3,7,3,2,6,7,2,1,7,3,2,7,6,0,7,6,6,6,0,3,0,4,0],
 [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0],
 [8,6,6,7,9,6,6,5,8,3,6,6,6,6,8,6,3,6,8,8,6,5,6,0,7,1],
 [8,6,7,6,8,6,5,7,8,4,6,6,6,6,8,7,4,5,8,9,7,4,7,0,6,2],
 [8,6,6,5,8,6,5,9,8,3,3,6,6,5,9,6,2,7,8,8,7,4,7,0,7,2],
 [6,6,7,6,6,4,6,4,6,2,3,7,7,8,5,6,0,8,8,8,3,3,4,3,4,3],
 [6,1,0,0,8,0,0,0,7,0,0,0,0,0,5,0,0,0,1,0,2,1,0,0,3,0],
 [7,3,3,4,7,3,2,8,7,2,2,4,4,6,7,3,0,5,5,5,2,1,4,0,3,1],
 [4,1,4,2,4,2,0,3,5,1,0,1,1,0,3,5,0,1,2,5,2,0,2,2,3,0],
 [6,6,6,6,6,6,5,5,6,3,3,5,6,5,8,6,3,5,7,6,4,3,6,2,4,2],
 [4,0,0,0,5,0,0,0,3,0,0,2,0,0,3,0,0,0,1,0,2,0,0,0,4,4]);
 
var sdd = [
[0,3,4,2,0,0,1,0,0,0,4,5,2,6,0,2,0,4,4,3,0,6,0,0,3,5],
[0,0,0,0,6,0,0,0,0,9,0,7,0,0,0,0,0,0,0,0,7,0,0,0,7,0],
[3,0,0,0,2,0,0,6,0,0,8,0,0,0,6,0,5,0,0,0,3,0,0,0,0,0],
[1,6,0,0,1,0,0,0,4,4,0,0,0,0,0,0,0,0,0,1,0,0,4,0,1,0],
[0,0,4,5,0,0,0,0,0,3,0,0,3,2,0,3,6,5,4,0,0,4,3,8,0,0],
[3,0,0,0,0,5,0,0,2,1,0,0,0,0,5,0,0,2,0,4,1,0,0,0,0,0],
[2,0,0,0,1,0,0,6,1,0,0,0,0,0,2,0,0,1,0,0,2,0,0,0,0,0],
[5,0,0,0,7,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,5,0,0,0,4,0,0,0,1,1,3,7,0,0,0,0,5,3,0,5,0,0,0,8],
[0,0,0,0,6,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,9,0,0,0,0,0],
[0,0,0,0,6,0,0,0,5,0,0,0,0,4,0,0,0,0,0,0,0,0,1,0,0,0],
[2,0,0,4,2,0,0,0,3,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,7,0],
[5,5,0,0,5,0,0,0,2,0,0,0,0,0,2,6,0,0,0,0,2,0,0,0,6,0],
[0,0,4,7,0,0,8,0,0,2,2,0,0,0,0,0,3,0,0,4,0,0,0,0,0,0],
[0,2,0,0,0,8,0,0,0,0,4,0,5,5,0,2,0,4,0,0,7,4,5,0,0,0],
[3,0,0,0,3,0,0,0,0,0,0,5,0,0,5,7,0,6,0,0,3,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0],
[1,0,0,0,4,0,0,0,2,0,4,0,0,0,2,0,0,0,0,0,0,0,0,0,5,0],
[1,1,0,0,0,0,0,1,2,0,0,0,0,0,1,4,4,0,1,4,2,0,4,0,0,0],
[0,0,0,0,0,0,0,8,3,0,0,0,0,0,3,0,0,0,0,0,0,0,2,0,0,0],
[0,4,3,0,0,0,5,0,0,0,0,6,2,3,0,6,0,6,5,3,0,0,0,0,0,6],
[0,0,0,0,8,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[6,0,0,0,2,0,0,6,6,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0],
[3,0,7,0,1,0,0,0,2,0,0,0,0,0,0,9,0,0,0,5,0,0,0,6,0,0],
[1,6,2,0,0,2,0,0,0,6,0,0,2,0,6,2,1,0,2,1,0,0,6,0,0,0],
[2,0,0,0,8,0,0,0,0,6,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,9]
];


 //T1 has compressed binary trigraph values
// had to replace \ by \\

// version constructed by construct_binary_trigraph_table.html with cutoff of 8.0
T1 = "" 
T1 += "t1r41IpAP2ph9^^44p1pAp2p`18>53Xhx@59b1I4V34A@2rXpA"
T1 += "p11s`M1Q1I4R74AHFp@p4tT1@>uPxXy4Xr2p8~p2|@4t4s8y1r"
T1 += "4u1qP~w83:2t1t8pPRXjr4r8uXRS:x1v@4111pPp2xAp444Aq@"
T1 += "s8q1x@{@2Q1z2p`M?^|@2p@x@4111s4A@@rYx@q1~~yHp735AH"
T1 += "2@6YIp2RPCpC@4@2P8pL1RC@p2:t144plAb8@4Qi1A4Vt@4pC8"
T1 += "sdOjN@6aiAe4V7r1@4Q9p@p43s@48r4~p18pPR88r4r8u8Pp2x"
T1 += "Ax11pHPR31w@s1~~tR1}822r1yTH8x@w4A@@rPx@4p1{1~~p4A"
T1 += "8Np4Pr2s@rQp1~{44s8y1q@41hpiWWG1wHp23}46>@s@42p41J"
T1 += "BpQp8p`44q18q?P`4w@sCT41TA@6@4191q8ygp\\64AHN@5QK1q"
T1 += "@p4A@2p6Pav2~~~~~~~~pPt4@@~y2~s14s@y4p@~~u`I<N@r1q"
T1 += "2r8pPVph6u8u325BxA444v1p42X3qDuAp4qAq@pP`pTp<~wD62"
T1 += "1x@p2p`;6^r1r2uP8Xx@u4r@2p3Phx@4p1p@4Ps4~z`oijD|LW"
T1 += "[;u1uT?o^5~q1r`In>y1@@p4u1p1D>v4~r@4rMTV3518qaXJpH"
T1 += "pV3p18q5pb4pPR3xAP4141@4@6UaqQP2p1TNtg3<6TA:>@GaiA"
T1 += "x4pPu1p:t42P{2pP922r1yPz@s@44u4pZp1w4rA4p2r4r@y4~~"
T1 += "~~~~~~s`?^L14w18pPk`b6@q141HsPpc~ynR?CQ1p64sAp44t4"
T1 += "P@p4p43~vNS[Cx@pRplM>n5q1r2s8pVhh2w@48r4q4A@qP@Zx@"
T1 += "4111A44pD@86@2@9}1PPugih4s4Ap@p4PqFcS;4p@rPr1p2`;^"
T1 += ">1w4p2@r1pA444q8:p4v4A@@@6QiAA4658p`8v4q1qPp8z4r@4"
T1 += "r1HqPx8~s4v@p1q^6RC11@q4u2p184@p1@~|2~Pp86~8X~t@q@"
T1 += "p8y4~~x8z4Pr2Rr@rP~~4pP8Z:y1@q4PPpA4~~~p4P~~~~~~r8"
T1 += "P1@P|82~|4XPt4~p@4pQu@p2~~~~~~~~~t"

/*
// cutoff of 5.0, right now 8.0 cutoff seems a little better
T1 ="sT1@>@7YiAITV3i?_^E>Yi@A4RpdMJ"
T1+="N57Xht@p@2`OYkAiWW75EHFQQphpi4"
T1+="W71r`O1[AIe_GeKjNpBpepI4RpTMJ>"
T1+="44rKPQ2sPg\\hx@4Xq<RS;q@rPq41s2"
T1+="6x4p2p@4111A44q18>x41@@@4Qh1A6"
T1+="65q`4v4t@pHXtX[n>4s1p4441:pP^j"
T1+="j>q4r8q1pPphR^Ox1Pu@41118RR3xA"
T1+="454TA8N@4QA18PU1v1p@s162tjRW31"
T1+="wAT64hO_n=q1r2p@q8@_Hi2w@4991s"
T1+="4A@@P``Yx@4111A4q4@H4q:av@vPQy"
T1+="iUW3EAHFB>YiA^b[KTCH6DFQ9plc_C"
T1+="a:ZnPsETV1lGkNEniiAieV7Q8p8@>@"
T1+="kIslOjNe>iiAmV^Wp4:;@6YI@iRV31"
T1+="1q@6Xiq4qP18>4w41:pPWih2A444q8"
T1+="q1pPpHPRC1wAPs@p@4111Hc_C1wAp4"
T1+="44A8N@PQA1r1v1t4p6:thUS31wAT64"
T1+="X8:Zr1p1p24t^hhx@p8u4A@@p2pPx@"
T1+="4p1114s8p@qI~P~TA8ND4YqNbSKp@@"
T1+="rQp14q2P1p<t4r4p2s1pA44@p8p<@x"
T1+="AD@@fYiAig_G1p@uiSWC1r`4HXu?V^"
T1+="A4AqA4V5TCJNTolh6hTV3UAH2pohkD"
T1+="w@5XIpoU^7UAL>DDUY583:;41`Dto5"
T1+="\\FTEJND]Yk1p1DpTAH2@niiA@rTp2:"
T1+="v1r@@y8~~w@~~~y4@Pt4A@@t@2~q2y"
T1+="4w14p4qd:x4p@p@p1w@~w`OlnE6A11"
T1+="I4VS5A:2Pomh6@p6q18q1pPpo2QOt1"
T1+="rAT44t4111l6^;pAdF2sA454TApL@1"
T1+="QapT1]1v1v62tlVRSxAT2ph=?^1q1r"
T1+="2p@q<@VXh@w@p81q44p4A@2pS`i4w@"
T1+="4111I4P74AHFpQXIv@uCPQtPomkGw@"
T1+="4Yqng_O3p@rQul?on5s@4T6q2q4rA4"
T1+="44`On>5w41@@@41q1625T?N>4s1p4t"
T1+="@p88x@VPh@mWV3UEJNTglj2iWW3UCJ"
T1+=">DOTiD4pR;t1PqoU^7UCN>DnmiDZSZ"
T1+="CT3nN4so7\\G]OONEomkEs41q@VQi@s"
T1+="d?O>5slR^31w@P2ph9?^r1r2p@q8pQ"
T1+="88x@48qA444pA@qWXkp1444s@4111I"
T1+="4V74@84pFPiy4sPQ}4x2P1~~u4~~~x"
T1+="hOnnE6@h@ApR1T1:4Pooj>i1V3U3H>"
T1+="p1p`pm397x1PqP1p8p411pnW_KU3nN"
T1+="6sA4444Aq@>QiHn;=3t4x22tlW_C5p"
T1+="@@q1qATVphOon5q1r2p@q8@ghiOs@p"
T1+="H2@49p1A4T44A@@1PhkpA4u@4A11A4"
T1+="V7DIHF`_kit41@uKPS3tomkGr44AH@"
T1+="@4Y9png[?5ABrPq41p3l?oN5s4pRp4"
T1+="A2@p411pI4TDX=N>D4@p1s4A@@`nik"
T1+="EE6^5lpj:tAp4q1q`6XXt`12p@FQi@"
T1+="D4R14AHqPQ8p@pV24A82p5phtP18uW"
T1+="P4pPADLD411pnW[CQ1@4@5PHpLpP2T"
T1+="CHND5QI1~s2u`3R1x1p2pPK:>5q1yN"
T1+="8hy4p1u@@qGhhy4q1p4~~r6Xhx@4Y8"
T1+="pnWSKq@rPq4q2P1p8t4r4p2q411pA4"
T1+="4@P8Z>x4A@@@6Yh1A6V5q@w4t`4HXw"
T1+="8}6Xi@~p1~~~~}8PSAP18>DpPqAp6p"
T1+="X9;Vq11r2s81z4PFYj4hpV34A@pP2p"
T1+="Pr8t@4pY1Ar4A:Ft1s1~~~w8~~~~}0"
*/
var bt = [];
 
var tri_table = new Array();
var tet_table = new Array();
var pent_table = new Array();
var alpha="ABCDEFGHIJKLMNOPQRSTUVWXYZ";	
var buffer = new Array();
//var base_digits = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";

var base64lookup = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
function base64Decode(s) {
 var len=s.length;
 var res = new Array();
 var index=0;
 var i=0;
 var chr1, chr2, chr3;
 var enc1, enc2, enc3, enc4;

 while(i<len) {
  enc1 = base64lookup.indexOf(s.charAt(i++));
  enc2 = base64lookup.indexOf(s.charAt(i++));
  enc3 = base64lookup.indexOf(s.charAt(i++));
  enc4 = base64lookup.indexOf(s.charAt(i++));
  res[index++] = (enc1 << 2) | (enc2 >> 4);
  res[index++] = ((enc2 & 15) << 4) | (enc3 >> 2);
  res[index++] = ((enc3 & 3) << 6) | enc4;
  
 }
 return res;
}


function get_di_score(buf_len){
	var score,i,n;
	
	// get digraph score
	score = 0.0;
	for (i=0;i<buf_len-1;i++){
		score += logdi[buffer[i]][buffer[i+1]];
	}
	return(score);
}	

function get_sdd_score(buf_len){
	var score,i,n;
	
	// get digraph score
	score = 0.0;
	for (i=0;i<buf_len-1;i++){
		score += sdd[buffer[i]][buffer[i+1]];
	}
	return(score);
}	



function construct_bt_table(){
    var i,n,index,c,ze,x,j,mask;
    // read T and put it into the working binary trigraph table: bt
    n = 26*26*26
    i = index = 0;

    ze = '0'.charCodeAt(0);
    while (i < n){
        c = T1.charCodeAt(index);
        index +=1
        //x = ord(c)-ord('0')
        x = c-ze;
        if (x > 63){
            x -= 63;
            //for j in range(6*x):
            for (j=0;j<6*x;j++){
                bt[i] = 0;
                i += 1;
            }
        }
        else{
            mask = 1;
            while (mask < 64){
                if (mask & x ){
                    bt[i] = 1;
                }
                else bt[i] = 0;
                i += 1;
                mask += mask;
                if (i >= n)  break;
            }
        }
    }
}


function get_btscore(buf_len){
    var score,i,n;
    // get tri score
    score = 0.0;
    for (i=0;i<buf_len-2;i++){
         n = buffer[i]+26*buffer[i+1]+26*26*buffer[i+2];
         score += bt[n];
    }
    return(score);
}    


function initialize_tri_table(){
	var i,c,n,v;

	for ( i = 0; i<26*26*26;i++)
		tri_table[i] = 0.0;
	for ( c in tri_values){
		n = alpha.indexOf(tri_values[c].charAt(0))+	26*alpha.indexOf(tri_values[c].charAt(1))
			+ 26*26*alpha.indexOf(tri_values[c].charAt(2));
		v = parseFloat(tri_values[c].slice(3));
		tri_table[n] = v;
	}
	//alert("tri_table initialized");
}	

function get_tri_score(buf_len){
	var score,i,n;
	
	// get trigraph score
	score = 0.0;
	for (i=0;i<buf_len-2;i++){
		n = buffer[i]+26*buffer[i+1]+26*26*buffer[i+2];
		score += tri_table[n];
	}
	return(score);
}	


function initialize_tet_table(){
	var i,c,n,v;

	for ( i = 0; i<26*26*26*26;i++)
		tet_table[i] = 0.0;
	for ( c in tet_values){
		n = alpha.indexOf(tet_values[c].charAt(0))+	26*alpha.indexOf(tet_values[c].charAt(1))
			+ 26*26*alpha.indexOf(tet_values[c].charAt(2))+ 26*26*26*alpha.indexOf(tet_values[c].charAt(3));
		v = parseFloat(tet_values[c].slice(4));
		tet_table[n] = v;
	}
}

function get_tet_score(buf_len){
	var score,i,n;
	
	// get trigraph score
	score = 0.0;
	for (i=0;i<buf_len-3;i++){
		n = buffer[i]+26*buffer[i+1]+26*26*buffer[i+2]+26*26*26*buffer[i+3];
		score += tet_table[n];
	}
	return(score);
}	

/*
function convert_to_base10(s){
	var i,n,c;
	var base = 62;
	
	n = 0;
	for (i=0;i<s.length;i++){
		c = s.charAt(i);
		n = base*n+base_digits.indexOf(c);
	}
	return(n);
}
*/
function initialize_pent_table(){
	var i,c,n,v,s,v1;
    var index;

	for ( i = 0; i<26*26*26*26*26;i++)
		pent_table[i] = 0.0;
    var p_values = base64Decode(pent_values);
    // p_values: 4 byte integer for pent index, followed by 2 byte log value scaled up by 100
    index = 0;
    for (i=0;i<p_values.length;i++){
        v = p_values[i];
        //if (v<0) v += 256; // unsigned integers, java needs this, don't know if javascript does, doesn't seem to.
        if(index == 0)
            n = v;
        else if (index==1) n+= 256*v;
        else if (index==2) n+= 256*256*v;
        else if (index==3) n+= 256*256*256*v;
        else if (index==4) v1=v;
        else if (index==5) {
            v1 += 256*v;
            pent_table[n] = v1/100.0; // table values already converted to logs
            index = -1;
        }
        index++;
    }
    //s = 'number of pent values is '+p_values.length;
	//alert(s);
}	
/*

function initialize_pent_table(){
	var i,c,n,v,s;

	for ( i = 0; i<26*26*26*26*26;i++)
		pent_table[i] = 0.0;
	for ( c in pent_values){
		s = pent_values[c].slice(0,4);
		n = convert_to_base10(s);
		s = pent_values[c].slice(4);
		v = convert_to_base10(s);
		pent_table[n] = Math.log(v+1);
	}
	//alert("pent_table initialized");
}	
*/
function get_score(buf_len){
	var score,i,n;
	
	// get pentagraph score
	score = 0.0;
	for (i=0;i<buf_len-4;i++){ 
		n = buffer[i]+26*buffer[i+1]+26*26*buffer[i+2]+26*26*26*buffer[i+3]+26*26*26*26*buffer[i+4];
		score += pent_table[n];
	}
	return(score);
}	
function do_calc(){
	var str, out_str,c,n,v,buf_len,pscore,i;
	var n_pscore;
	var trscore,n_trscore,tscore,n_tscore,dscore,n_dscore;
    var btscore,n_btscore,sdd_score, n_sdd_score;


	//initialize_pent_table();
	str = document.getElementById('input_area').value;
	// convert input string to indices
	str = str.toUpperCase();
	buf_len = 0;
	for ( i=0;i<str.length;i++){
		c = str.charAt(i);
		n = alpha.indexOf(c);
		if ( n>=0)
			buffer[buf_len++] = n;
	}
	// get scores
	out_str = "Length of text: "+buf_len+"\n";
	if (buf_len<5){
		alert("Text too short!");
		return;
	}
		
	dscore = get_di_score(buf_len);
	n_dscore = 100*dscore/(buf_len-1);	
	out_str += "log digraph score: "+dscore.toFixed(2)+" ,Normalized: "+n_dscore.toFixed(2);
	out_str +=" ,Average for English: 750\n";
	
	sdd_score = get_sdd_score(buf_len);
	n_sdd_score = 100*sdd_score/(buf_len-1);	
	out_str += "SDD score: "+sdd_score.toFixed(2)+" ,Normalized: "+n_sdd_score.toFixed(2);
	out_str +=" ,Average for English: 311\n";



    btscore = get_btscore(buf_len);
    n_btscore = 1000*btscore/(buf_len-2); ///multiply by 1000 to make normalized score close to aveage log digraph score.
	out_str += "binary trigraph score: "+btscore.toFixed(2)+" ,Normalized: "+n_btscore.toFixed(2);    
    out_str += ',Average for English: 740\n';
	
	trscore = get_tri_score(buf_len);
	n_trscore = 100*trscore/(buf_len-2);	
	out_str += "log trigraph score: "+trscore.toFixed(2)+" ,Normalized: "+n_trscore.toFixed(2);
	out_str +=" ,Average for English: 879\n";
	
	tscore = get_tet_score(buf_len);
	n_tscore = 100*tscore/(buf_len-3);	
	out_str += "log tetragraph score: "+tscore.toFixed(2)+" ,Normalized: "+n_tscore.toFixed(2);
	out_str +=" ,Average for English: 404\n";
	
	pscore = get_score(buf_len);
	n_pscore = 100*pscore/(buf_len-4);
	out_str += "log pentagraph score: "+pscore.toFixed(2)+" ,Normalized: "+n_pscore.toFixed(2);
	out_str +=" ,Average for English: 470\n";
	
	document.getElementById('output_area').value = out_str;		
}

function do_clear(){
	document.getElementById('input_area').value = '';
	document.getElementById('output_area').value = '';
}
</script>
</head>
<body bgcolor="Silver" >
<center><h3> n-graph scores </h3>
(Ignore word divisions)</center>
<br>

Paste or type text:<br>
<textarea id="input_area" cols=80 rows=10 >
</textarea><br>
Scores:<br>
<textarea id="output_area" cols=80 rows = 8>
</textarea>
<br>
<input type="button" value="Get score" onclick=do_calc();>
&nbsp &nbsp
<input type="button" value="Clear" onclick=do_clear();>
<script type="text/javascript">
construct_bt_table(); // binary trigraphs
initialize_tri_table();
initialize_tet_table();
initialize_pent_table();

</script>

</body>
</html>
